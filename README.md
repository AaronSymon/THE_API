# THE_API
An experimental project to simplify the creation of RESTful APIs by using Node.js, Express.js, Typescript, TypeORM and Mysql.

**Note:**
1. RESTFul API generated by this project need to have a user account and be logged, you can edit the user.the.ts file in folder `src/theObject`,
but it is not recommanded to delete it
2. This project is still an alpha version, so please don't use it in production environment.

## Table of contents

1. [How to use it](#how-to-use-it)
2. [About](#about)
    1. [.env file](#env-file)
    2. [theObject and the files](#theobject-and-the-files)
        1. [theObject](#theobject)
    3. [Entities](#entities)
    4. [Caches](#caches)
    5. [Access](#access)
    6. [DTOs](#dtos)
    7. [Routers](#routers)
    8. [Documentation](#documentation)
        1. [Swagger](#swagger)
        2. [Swagger implementation](#swagger-implementation)
    9. [Migrations](#migrations)
    10. [Logs](#logs)
    11. [Securities](#securities)
        1. [Tokens](#tokens)
        2. [Passwords](#passwords)

## How to use it

1. Clone the repository
2. Run `npm install` to install all the dependencies
3. Create your entity_name.the.ts files in the `src/theObject` folder
4. Create your database and configure the [.env](#env-file)
5. Run `npm run generate:theApi` to generate all the files required to configure and manage your API
6. Run `npm run migration:generate` and `npm run migration:run` to create the tables in the database
7. Run `npm run start:swagger` to generate the server and generate the swagger documentation / Run `npm start` to start the server without generate swagger documentation if it was already generated

## About

### .env file
In the code below, a `.env` file example. Place it to the root of the project. Use it to configure the database connection and you're app
```
#App data
APP_NAME: 'Name of your project'
APP_VERSION: 'Version of your project'
APP_DESCRIPTION: 'Description of your project'

#Server Config
SV_PORT: 3000
SV_HOSTNAME: 'localhost'

#DataBaseConfig
DB_HOST:'localhost'
DB_PORT: 3306
DB_USER: 'root'
DB_PASSWORD: 'your_password'
DB_DATABASE: 'name_of_your_database'
DB_CHARSET: 'utf8mb4'
DB_POOL_SIZE: 10
DB_PREFIX: 'prefix_of_your_database_tables'

#Logs
LOG_LIMIT_SIZE: 1000000 #1Mo #Limit size of log file
LOG_LIMIT_FILES: 10 #Limit number of log files

#Cache
#Timer to define how long data will be stored in cache
CA_TIMER: 30000 #Milliseconds #30Secondes

#Tokens secret keys
TK_SECRETKEY: 'your_secret_key_for_token'
TK_SECRETREFRESHKEY: 'your_secret_key_for_refresh_token'

#Timer to define how long tokens will be valid
# '20s' = 20 seconds, '1m' = 1 minute, '2h' = 2 hours, '1d' = 1 day
TK_VALIDTOKENTIMER: '20m' #Timer to define how long tokens will be valid
TK_VALIDREFRESHTOKENTIMER: '3d' #Timer to define how long refresh tokens will be valid

TL_TIMER: 7200000

```

### theObject and the files

**One \*.the.ts file = one const \*: theObject** <br>

#### theObject

The `theObject` is an object that contains all the properties required to configure and manage the API in one place. <br>
By defining it, you can manage your entites and their properties, the dtos, the access for each user role and the caches. <br>

```
//Explanaition of theObject properties

theObject = {

    entity: { //Data of your entity and its Dto
        entityName: string, //Name of your entity, correspond to the name of the table in the database
        columns?: [ //Columns of your entity, correspond to the columns of the table in the database
            {
                name: string, //Name of the column
                type: "string" | "number" | "Date" | "boolean" | "Blob", //typescript type of the column
                options: {
                    nullable: boolean, //is the column can be null
                    unique?: boolean, //is the values of the collumn are unique
                    columnType: ColumnType, //type of the column in the database ("VarChar, Char, Int,...")
                    default?: string | number | boolean | Date | null, //default value of the column in the database
                },
            },
        ],
        relations?: [
            {
                name: string, //Name of the relation
                type: "OneToOne" | "OneToMany" | "ManyToOne" | "ManyToMany", //Type of the relation
                relationWith: string, //Name of the entity with which the relation is made,
                manyToManyOwningSide?: boolean, //Is the relation is a manyToMany relation and the entity is the owning side
                oneToManyJoinTable?: string, //Name of the join table column if the relation is a manyToOne relation
                manyToManyJoinTable?: string //Name of the join table column if the relation is a manyToMany relation
            },
        ],
        dtoExcludedColumns?: string[], //Columns of the entity that you don't want to include in the dto
        dtoExcludedRelations?: string[], //Relations of the entity that you don't want to include in the dto
    },
    cache: { //Data of the cache
        isEntityCached: boolean, //Is the entity have to be cached
    },
    access: [ //Data of the different user roles and their access
        {
            userRole: undefined |"User" | "Admin" | "SuperAdmin", //User role for which the access is defined
            httpMethods: Set<"GET" | "POST" | "PUT" | "DELETE">, //HTTP methods allowed for the user role
            getAccessParams?: string[], //Params allowed for the GET method for the user role
            getAccessRelations?: string[], //Relations allowed for the GET method for the user role
        },
    ]

}

```




### Entities

### Caches

### Access

### DTOs

### Routers

### Documentation

#### Swagger

#### Swagger implementation

### Migrations

### Logs

### Securities

#### Tokens

#### Passwords